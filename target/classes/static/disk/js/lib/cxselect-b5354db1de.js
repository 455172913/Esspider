!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery||window.Zepto||window.$)}(function(t){t.cxSelect=function(){var e={dom:{},api:{}};return e.init=function(){for(var e,n=this,s=function(t){return t&&("function"==typeof HTMLElement||"object"==typeof HTMLElement)&&t instanceof HTMLElement?!0:!(!t||!t.nodeType||1!==t.nodeType)},a=function(t){return!!(t&&t.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&t instanceof jQuery)},i=0,o=arguments.length;o>i;i++)a(arguments[i])?n.dom.box=arguments[i]:s(arguments[i])?n.dom.box=t(arguments[i]):"object"==typeof arguments[i]&&(e=arguments[i]);if(n.dom.box.length){n.settings=t.extend({},t.cxSelect.defaults,e,{url:n.dom.box.data("url"),nodata:n.dom.box.data("nodata"),required:n.dom.box.data("required"),firstTitle:n.dom.box.data("firstTitle"),firstValue:n.dom.box.data("firstValue"),jsonSpace:n.dom.box.data("jsonSpace"),jsonName:n.dom.box.data("jsonName"),jsonValue:n.dom.box.data("jsonValue"),jsonSub:n.dom.box.data("jsonSub")});var r=n.dom.box.data("selects");if("string"==typeof r&&r.length&&(n.settings.selects=r.split(",")),t.isArray(n.settings.selects)&&n.settings.selects.length){n.selectArray=[];for(var l,i=0,o=n.settings.selects.length;o>i&&(l=n.dom.box.find("select."+n.settings.selects[i]),l);i++)"string"==typeof l.val()&&l.val().length&&l.attr("data-value",l.val()),n.selectArray.push(l);n.selectArray.length&&(n.dom.box.on("change","select",function(){n.selectChange(this.className)}),n.settings.url?"string"==typeof n.settings.url&&n.settings.url.length?t.getJSON(n.settings.url,function(t){n.start(t)}):"object"==typeof n.settings.url&&n.start(n.settings.url):n.start())}}},e.getIndex=function(t){return this.settings.required?t:t-1},e.start=function(t){var e=this,n=e.settings.jsonSpace;if(e.dataJson=void 0,t&&"object"==typeof t&&(e.dataJson=t,"string"==typeof n&&n.length))for(var s=n.split("."),a=0,i=s.length;i>a;a++)e.dataJson=e.dataJson[s[a]];e.dataJson||"string"==typeof e.selectArray[0].data("url")&&e.selectArray[0].data("url").length?e.getOptionData(0):e.selectArray[0].prop("disabled",!1).css({display:"",visibility:""})},e.selectChange=function(t){if("string"==typeof t&&t.length){t=t.replace(/\s+/g,","),t=","+t+",";for(var e,n=0,s=this.selectArray.length;s>n;n++)t.indexOf(","+this.settings.selects[n]+",")>-1&&(e=n);"number"==typeof e&&(e+=1,this.getOptionData(e))}},e.getOptionData=function(e,n){var s=this;if(!("number"!=typeof e||isNaN(e)||0>e||e>=s.selectArray.length)){for(var a,i,o,r,l,d=e-1,f=s.selectArray[e],u={},g=f.data("url"),c="undefined"==typeof f.data("jsonSpace")?s.settings.jsonSpace:f.data("jsonSpace"),p=0,y=s.selectArray.length;y>p;p++)p>=e&&(s.selectArray[p].empty().prop("disabled",!0),"none"===s.settings.nodata?s.selectArray[p].css("display","none"):"hidden"===s.settings.nodata&&s.selectArray[p].css("visibility","hidden"));if("string"==typeof g&&g.length){if(d>=0){if(!s.selectArray[d].val().length)return;r=f.data("queryName"),l=s.selectArray[d].attr("name"),"string"==typeof r&&r.length?u[r]=s.selectArray[d].val():"string"==typeof l&&l.length&&(u[l]=s.selectArray[d].val())}t.getJSON(g,u,function(t){if(i=t,"string"==typeof c&&c.length)for(var e=c.split("."),n=0,a=e.length;a>n;n++)i=i[e[n]];s.buildOption(f,i)})}else if(s.dataJson&&"object"==typeof s.dataJson){i=s.dataJson;for(var p=0,y=s.selectArray.length;y>p;p++)e>p&&(o=s.getIndex(s.selectArray[p][0].selectedIndex),"object"==typeof i[o]&&t.isArray(i[o][s.settings.jsonSub])&&i[o][s.settings.jsonSub].length&&(a=p,i=i[o][s.settings.jsonSub]));(0>d||d===a)&&s.buildOption(f,i)}}},e.buildOption=function(e,n){var s=this,a="undefined"==typeof e.data("firstTitle")?s.settings.firstTitle:String(e.data("firstTitle")),i="undefined"==typeof e.data("firstValue")?s.settings.firstValue:String(e.data("firstValue")),o="undefined"==typeof e.data("jsonName")?s.settings.jsonName:String(e.data("jsonName")),r="undefined"==typeof e.data("jsonValue")?s.settings.jsonValue:String(e.data("jsonValue"));if(t.isArray(n)){var l=s.settings.required?"":'<option value="'+i+'">'+a+"</option>";if(o.length){r.length||(r=o);for(var d=0,f=n.length;f>d;d++)l+='<option value="'+String(n[d][r])+'">'+String(n[d][o])+"</option>"}else for(var d=0,f=n.length;f>d;d++)l+='<option value="'+String(n[d])+'">'+String(n[d])+"</option>";e.html(l).prop("disabled",!1).css({display:"",visibility:""}),"undefined"!=typeof e.data("value")&&e.val(String(e.data("value"))).removeAttr("data-value"),e.trigger("change")}},e.init.apply(e,arguments),this},t.cxSelect.defaults={selects:[],url:null,nodata:null,required:!1,firstTitle:"请选择",firstValue:"",jsonSpace:"",jsonName:"n",jsonValue:"",jsonSub:"s"},t.fn.cxSelect=function(e,n){return this.each(function(s){t.cxSelect(this,e,n)}),this}});